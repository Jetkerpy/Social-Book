{% extends 'base.html' %}



{% block content %}

<style>
    .sender_image{
        width: 50px;
        height: 50px;
        border-radius: 50%;
    }
    .message_text_noti{
        color: #565959;
        font-size: 20px;
        font-weight: 400;

    }
    .sender_profile{
        margin-right: 20px;
        
    }
    .profile_user{
        font-weight: 700;
        color: #007185;
        cursor: pointer;
        text-decoration: none;
    }
    .hidden{
        display: none;
    }
    .noti_message{
        color: #0f1111;
        font-weight: 700;
        size: 14px;
    }

    .book_image{
        width: 100px;
        border-radius: 12px;
    }
</style>

    <div class="row mt-4 justify-content-center">
        <div class="card p-2 shadow col-md-10 col-sm-12">

            {% for noti in notifications %}
                <!-- follow message  -->
                {% if noti.notification_types == 3%}

                <h3 class="text-center">Hi  {{ noti.receiver|title }}</h3>
                
                <div class="d-flex justify-content-between">
                    <div class="sender_profile text-center">
                        <a href="{% url 'myaccount:my-account' noti.sender.pk%}">
                            <img class="sender_image" src="{{ noti.sender.profile_img.url}}" alt="{{ noti.sender}}">
                            <small class="lead">@{{ noti.sender.username}}</small>
                        </a>
                        <div class="mt-4" id="add-hidden">
                            <i id="accept" data-pk="{{ noti.sender.pk}}" class="fa-solid fa-check fs-3 me-4 text-success"></i>
                            <input type="hidden" id="input" name="receiver" value="{{ noti.receiver }}">
                            <input type="hidden" id="input2" name="sender" value="{{ noti.sender }}">
                            <i id="cancel" class="fa-solid fa-x fs-3 text-danger"></i>
                        </div>
                    </div>
                    <div class="message">
                        <p class="lead">{{ noti.message_text}}</p>
                        <small>{{ noti.updated|timesince}} ago</small>
                    </div>
                </div>
                <hr>
                {% endif %}
                <!-- follow message  -->
                <!-- Like message  -->
                {% if noti.notification_types == 1 %}

                <h3 class="text-center">Hi  {{ noti.receiver|title }}</h3>
                
                        <div class="row mt-3 justify-content-center">
                            <div class="sender_profile text-center col-md-5 col-sm-12">
                                <a href="{% url 'myaccount:my-account' noti.sender.pk%}" class="profile_user">
                                    <img class="sender_image" src="{{ noti.sender.profile_img.url}}" alt="{{ noti.sender}}">
                                    <small class="lead">@{{ noti.sender.username}}</small>
                                </a>
                                <p class="message_text_noti">{{ noti.message_text}}</p>
                            </div>
                            <div class="message col-md-5 col-sm-12 ">
                                <div class="text-center">
                                    {% if noti.book.image %}
                                    <img class="book_image" src="{{ noti.book.image.url }}" alt="{{ noti.book.name}}">
                                    {% endif %}
                                </div>
                                <p class="noti_message text-center">"{{ noti.book.name }}" kitabin'izg'a unamli tu'rde kitabin'iz unadi malades keep it up.Bul bizge Motivatsiya boladi</p>
                                <small class="ms-3">{{ noti.updated|timesince}} ago</small>
                            </div>
                        </div>
                <hr>


                {% endif %}

                <!-- Like message  -->

                <!-- About book discussion room -->

                {% if noti.notification_types == 4 %}

                <h3 class="text-center">Hi  {{ noti.receiver|title }}</h3>
                
                        <div class="row mt-3 justify-content-center">
                            <div class="sender_profile text-center col-md-5 col-sm-12">
                                <a href="{% url 'myaccount:my-account' noti.sender.pk%}" class="profile_user">
                                    <img class="sender_image" src="{{ noti.sender.profile_img.url}}" alt="{{ noti.sender}}">
                                    <small class="lead">@{{ noti.sender.username}}</small>
                                </a>
                                <p class="message_text_noti">{{ noti.message_text}}</p>
                            </div>
                            <div class="message col-md-5 col-sm-12 ">
                                <div class="text-center">
                                    {% if noti.book.image %}
                                    <img class="book_image" src="{{ noti.book.image.url }}" alt="{{ noti.book.name}}">
                                    {% endif %}
                                </div>
                                <p class="noti_message text-center">"{{ noti.book.name }}" discussion yag'niy oz-ara pikir almasiw ushin oz qizigiwlishin bildirdi!!</p>
                                <small class="ms-3">{{ noti.updated|timesince}} ago</small>
                            </div>
                        </div>
                <hr>


                {% endif %}




                {% empty %}
                <div class="display-5 text-center text-info">
                    No notification yet...
                </div>
                

            {% endfor %}


            
     
        </div>
    </div>

   
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> -->
   
   
   
    <!-- Accept and Cancel -->
    <script>

        const accept = document.getElementById('accept')
        const cancel = document.getElementById('cancel')
        const add_hidden = document.getElementById('add-hidden')
        const input = document.getElementById('input')
        const input2 = document.getElementById('input2')

        accept.addEventListener('click', (e)=>{
            const data = {receiver: input.value, sender: input2.value}

            $.ajax({
                type: 'GET',
                url: "{% url 'accept' %}",
                data: data,
                timeout: 5000,
                success: function(data){
                   
                },
                error: function(data){
            
                }
            })
            add_hidden.classList.add('hidden')
        })

        cancel.addEventListener('click', (e)=>{
            const data = {receiver: input.value, sender: input2.value}
            $.ajax({
                type: 'GET',
                url: "{% url 'cancel' %}",
                data: data,
                timeout: 5000,
                success: function(data){
                    // console.log(data)
                },
                error: function(data){

                }
            })

            add_hidden.classList.add('hidden')

        })



    


    </script>

    


{% endblock content %}